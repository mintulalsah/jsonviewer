<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Custom JSON Viewer</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    
    .json-key {
      color: blue;
    }
    
    .json-string {
      color: green;
    }
    
    .json-number {
      color: red;
    }
    
    .json-boolean {
      color: purple;
    }
    
    .json-null {
      color: gray;
    }
    
    .json-collapsed .json-child {
      display: none;
    }
    
    .json-toggle {
      cursor: pointer;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h2>Data</h2>
  <button id="collapse-btn">Collapse</button>
  <button id="expand-btn">Expand</button>
  <button id="toggle-btn">Toggle</button>
  <button id="toggle-level1-btn">Toggle level1</button>
  <button id="toggle-level2-btn">Toggle level2</button>
  <pre id="json"></pre>
  
  <script>
    var json = {
      "hey": "guy",
      "anumber": 243,
      "anobject": {
        "whoa": "nuts",
        "anarray": [1, 2, "thr<h1>ee"],
        "more": "stuff"
      },
      "awesome": true,
      "bogus": false,
      "meaning": null,
      "japanese": "明日がある。",
      "link": "http://jsonview.com",
      "notLink": "http://jsonview.com is great",
      "multiline": [
        'Much like me, you make your way forward,',
        'Walking with downturned eyes.',
        'Well, I too kept mine lowered.',
        'Passer-by, stop here, please.'
      ].join("\n")
    };

    function renderJSON(obj, container) {
      if (typeof obj === 'object' && obj !== null) {
        var isArray = Array.isArray(obj);
        var collapsible = !isArray && Object.keys(obj).length > 0;

        var jsonWrapper = document.createElement('div');
        jsonWrapper.className = collapsible ? 'json-object json-toggle' : 'json-object';

        var jsonContent = document.createElement('div');
        jsonContent.className = 'json-child';

        if (collapsible) {
          var toggleButton = document.createElement('span');
          toggleButton.className = 'json-toggle';
          toggleButton.textContent = isArray ? '[]' : '{}';
          toggleButton.addEventListener('click', function () {
            jsonContent.style.display = jsonContent.style.display === 'none' ? 'block' : 'none';
          });
          jsonWrapper.appendChild(toggleButton);
        }

        if (!isArray) {
          for (var key in obj) {
            if (obj.hasOwnProperty(key)) {
              var keyElement = document.createElement('span');
              keyElement.className = 'json-key';
              keyElement.textContent = key + ': ';
              jsonContent.appendChild(keyElement);
              renderJSON(obj[key], jsonContent);
              var comma = document.createElement('span');
              comma.textContent = ', ';
              jsonContent.appendChild(comma);
            }
          }
          if (Object.keys(obj).length > 0) {
            jsonContent.removeChild(jsonContent.lastChild); // Remove the last comma
          }
        } else {
          for (var i = 0; i < obj.length; i++) {
            renderJSON(obj[i], jsonContent);
            if (i < obj.length - 1) {
              var comma = document.createElement('span');
              comma.textContent = ', ';
              jsonContent.appendChild(comma);
            }
          }
        }

        jsonWrapper.appendChild(jsonContent);
        container.appendChild(jsonWrapper);
      } else {
        var valueElement = document.createElement('span');
        valueElement.className = getValueTypeClass(obj);
        valueElement.textContent = formatValue(obj);
        container.appendChild(valueElement);
      }
    }

    function getValueTypeClass(value) {
      if (typeof value === 'string') {
        return 'json-string';
      } else if (typeof value === 'number') {
        return 'json-number';
      } else if (typeof value === 'boolean') {
        return 'json-boolean';
      } else if (value === null) {
        return 'json-null';
      }
      return '';
    }

    function formatValue(value) {
      if (typeof value === 'string') {
        return '"' + value + '"';
      }
      return String(value);
    }

    function collapseJSON(container) {
      var collapsibleElements = container.getElementsByClassName('json-toggle');
      for (var i = 0; i < collapsibleElements.length; i++) {
        var element = collapsibleElements[i];
        var child = element.nextElementSibling;
        if (child && child.className.indexOf('json-child') !== -1) {
          child.style.display = 'none';
        }
      }
    }

    function expandJSON(container) {
      var collapsibleElements = container.getElementsByClassName('json-toggle');
      for (var i = 0; i < collapsibleElements.length; i++) {
        var element = collapsibleElements[i];
        var child = element.nextElementSibling;
        if (child && child.className.indexOf('json-child') !== -1) {
          child.style.display = 'block';
        }
      }
    }

    function toggleJSON(container) {
      var collapsibleElements = container.getElementsByClassName('json-toggle');
      for (var i = 0; i < collapsibleElements.length; i++) {
        var element = collapsibleElements[i];
        var child = element.nextElementSibling;
        if (child && child.className.indexOf('json-child') !== -1) {
          child.style.display = child.style.display === 'none' ? 'block' : 'none';
        }
      }
    }

    function toggleLevel(container, level) {
      var collapsibleElements = container.getElementsByClassName('json-toggle');
      for (var i = 0; i < collapsibleElements.length; i++) {
        var element = collapsibleElements[i];
        var child = element.nextElementSibling;
        var depth = getDepth(element);
        if (child && child.className.indexOf('json-child') !== -1 && depth === level) {
          child.style.display = child.style.display === 'none' ? 'block' : 'none';
        }
      }
    }

    function getDepth(element) {
      var depth = 0;
      while (element.parentElement) {
        if (element.classList.contains('json-object')) {
          depth++;
        }
        element = element.parentElement;
      }
      return depth;
    }

    document.getElementById('collapse-btn').addEventListener('click', function () {
      collapseJSON(document.getElementById('json'));
    });

    document.getElementById('expand-btn').addEventListener('click', function () {
      expandJSON(document.getElementById('json'));
    });

    document.getElementById('toggle-btn').addEventListener('click', function () {
      toggleJSON(document.getElementById('json'));
    });

    document.getElementById('toggle-level1-btn').addEventListener('click', function () {
      toggleLevel(document.getElementById('json'), 1);
    });

    document.getElementById('toggle-level2-btn').addEventListener('click', function () {
      toggleLevel(document.getElementById('json'), 2);
    });

    renderJSON(json, document.getElementById('json'));
  </script>
</body>
</html>
